# 后台数据保存设置指南

本指南将帮助您设置 Google Sheets 来保存所有顾客的评估记录。

## 📋 方案：使用 Google Sheets（推荐）

### 优点
- ✅ 完全免费
- ✅ 无需服务器
- ✅ 数据存储在 Google 云端，安全可靠
- ✅ 可以随时查看、导出、分析数据
- ✅ 支持多人协作查看

### 设置步骤

#### 步骤 1: 创建 Google Sheets

1. 打开 [Google Sheets](https://sheets.google.com)
2. 创建一个新的空白表格
3. 在第一行输入以下表头（A1 到 W1）：
   ```
   A1: 时间
   B1: 姓名
   C1: 行业
   D1: 最希望学习的AI技能
   E1: # 总分
   F1: 等级
   G1: 等级文本
   H1: 内容得分
   I1: 广告得分
   J1: AI应用得分
   K1: 自动化得分
   L1: 数据能力得分
   M1: 问题1
   N1: 问题2
   O1: 问题3
   P1: 问题4
   Q1: 问题5
   R1: 问题6
   S1: 问题7
   T1: 问题8
   U1: 问题9
   V1: 问题10
   W1: 问题11
   X1: 问题12
   Y1: 诊断分析
   Z1: 建议优先级
   ```
4. **重要**：保存并记下这个 Google Sheets 的 ID
   - 在 URL 中可以找到，例如：`https://docs.google.com/spreadsheets/d/SPREADSHEET_ID/edit`
   - 复制 `SPREADSHEET_ID` 部分

#### 步骤 2: 创建 Google Apps Script

1. 在同一个 Google Sheets 中，点击菜单栏的 **扩展程序** > **Apps Script**
2. 如果看到示例代码，全部删除
3. 打开项目中的 `google-apps-script.js` 文件
4. 复制所有代码并粘贴到 Google Apps Script 编辑器
5. **重要**：修改第 8 行的 `SPREADSHEET_ID`：
   ```javascript
   const SPREADSHEET_ID = '你的Google_Sheets_ID'; // 替换这里
   ```
6. 点击 **保存**（💾 图标）

#### 步骤 3: 部署为 Web App

1. 在 Google Apps Script 编辑器中，点击 **部署** > **新建部署**
2. 点击 **选择类型** 旁边的齿轮图标 ⚙️
3. 选择 **Web 应用**
4. 填写部署设置：
   - **说明**：可以填写 "问卷数据收集" 或留空
   - **执行身份**：选择 **我**
   - **具有访问权限的用户**：选择 **任何人**（重要！）
5. 点击 **部署**
6. **重要**：复制 **Web 应用 URL**（类似：`https://script.google.com/macros/s/.../exec`）
7. 点击 **完成**

#### 步骤 4: 更新问卷代码

1. 打开 `index.html` 文件
2. 找到第 1159 行左右的配置：
   ```javascript
   const GOOGLE_SCRIPT_URL = '你的Web_App_URL';
   ```
3. 将 `你的Web_App_URL` 替换为步骤 3 中复制的 Web 应用 URL
4. 确保 `ENABLE_GOOGLE_SHEETS = true;`
5. 保存文件

#### 步骤 5: 测试

1. 打开问卷页面
2. 填写并提交一份测试问卷
3. 打开 Google Sheets，应该能看到新的一行数据
4. 如果数据没有出现，检查：
   - Google Apps Script 的 **执行** > **查看执行记录**
   - 浏览器控制台（F12）是否有错误

## 🔍 查看数据

### 在 Google Sheets 中查看
- 所有提交的记录会自动添加到表格中
- 可以排序、筛选、分析数据
- 可以导出为 Excel 或 CSV

### 数据分析建议
- 使用 Google Sheets 的筛选功能查看特定行业的数据
- 使用图表功能分析分数分布
- 使用数据透视表分析最想学习的 AI 技能

## ⚙️ 高级配置

### 自动设置表头
如果您的表还没有表头，可以在 Google Apps Script 中运行 `setupHeaders()` 函数自动创建。

### 修改数据格式
如果需要修改保存的数据格式，编辑 `google-apps-script.js` 中的 `processData` 函数。

## 🔒 安全提示

1. **保护您的 Google Sheets**：
   - 不要将 Google Sheets 设置为"任何人可编辑"
   - 只允许特定人员查看数据

2. **保护 Web App URL**：
   - 不要公开分享 Web App URL
   - 如果 URL 泄露，可以在 Google Apps Script 中重新部署获取新 URL

## ❓ 常见问题

### Q: 数据没有保存到 Google Sheets？
A: 检查：
1. Web App 是否已部署
2. 访问权限是否设置为"任何人"
3. Google Apps Script 执行记录中是否有错误
4. 浏览器控制台是否有错误

### Q: 如何查看执行记录？
A: 在 Google Apps Script 编辑器中，点击 **执行** > **查看执行记录**

### Q: 可以修改保存的数据格式吗？
A: 可以，编辑 `google-apps-script.js` 中的 `processData` 函数

### Q: 数据会保存多久？
A: 数据会永久保存在 Google Sheets 中，除非您手动删除

## 📞 需要帮助？

如果遇到问题：
1. 检查浏览器控制台（F12）的错误信息
2. 检查 Google Apps Script 的执行记录
3. 确认所有配置步骤都已完成

